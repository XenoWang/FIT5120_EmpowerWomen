{% extends 'base.html' %}

{% block title %}Career Pathway - EmpowerWomen{% endblock %}

{% block content %}

<div class="container-career">
    <div class="row" style="margin-top: 10vh; margin-bottom: 10vh;">
        <div class="col">
            <img src="/static/Image/career.jpg" class="career-image">
        </div>
        <div class="col col-text">
            <div class="heading">
                Career Pathways
            </div>
            <br>
            <div class="paragraphs">
                Realise your career ambitions with Equalwomen
            </div>
        </div>
    </div>

    <div class="row" style="margin-top: 10vh; margin-bottom: 10vh;">
        <div class="col col-text">
            <div class="heading">About Career Pathways</div>
            <br>
            <div class="paragraphs">
                Below is a selection of common career pathways to explore<br>
                Realise your career ambitions with Equalwomen
            </div>
        </div>

        <div class="col">
            <img src="/static/Image/career2.jpg" class="career-image">
        </div>
    </div>
</div>

<div class="category-container">
    <div class="category" onclick="toggleExpansion('art')">
        <img src="path_to_art_image.jpg" alt="Art">
        <div>
            <h2>{{ occupation }}</h2>
            <p>Find out what career pathways are related to {{ occupation }}</p>
        </div>
        <button class="expand-button">+</button>
    </div>
    <div class="expansion-panel" id="art">
        <!-- Dynamic content will be inserted here -->
    </div>
</div>

<style>
    .category-container {
        margin: 20px;
        padding: 10px;
        background-color: #f0f0f0;
        border-radius: 8px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .category {
        display: flex;
        align-items: center;
        cursor: pointer;
    }

    .category img {
        width: 50px;
        height: 50px;
        border-radius: 50%;
    }

    .expand-button {
        margin-left: auto;
        background: none;
        border: none;
        font-size: 24px;
        cursor: pointer;
    }

    .expansion-panel {
        height: 0;
        overflow: hidden;
        transition: height 0.3s ease;
    }

    .category h2, .category p {
        margin-left: 10px;
    }

    .career-detail {
        margin-bottom: 20px;
    }
</style>

<!-- The career pathway data is dynamically injected into the HTML here -->
<script type="text/javascript">
    var careerPathwayData = {{ career_pathway_json | safe }};
</script>

<script type="text/javascript">
    // Recursive function to create career pathway HTML dynamically
    function createCareerHTML(level, title) {
        let html = `
            <div class="career-detail">
                <h3>${title} - ${level.job_title}</h3>
                <p><strong>Years of Commitment:</strong> ${level.years_of_commitment}</p>
                <p><strong>Description:</strong> ${level.description}</p>
                <p><strong>Skills:</strong> ${level.skills.join(', ')}</p>
            </div>
        `;

        if (level.next_steps) {
            for (let key in level.next_steps) {
                const nextStep = level.next_steps[key];
                html += createCareerHTML(nextStep, capitalizeWords(key.replace('_', ' ')));
            }
        }

        return html;
    }

    // Function to insert the career pathway data into the expansion panel
    function insertCareerPathwayData() {
        const panel = document.getElementById('art');
        const careerTree = careerPathwayData.response.career_tree;

        // Clear existing content
        panel.innerHTML = '';

        // Dynamically loop through the career tree levels
        for (let level in careerTree) {
            const entryLevel = careerTree[level];
            const levelHTML = createCareerHTML(entryLevel, capitalizeWords(level.replace('_', ' ')));
            panel.innerHTML += levelHTML;
        }
    }

    // Helper function to capitalize words
    function capitalizeWords(str) {
        return str.replace(/\b\w/g, char => char.toUpperCase());
    }

    // Function to toggle the expansion panel
    function toggleExpansion(id) {
        const panel = document.getElementById(id);
        if (panel.style.height) {
            panel.style.height = null;
        } else {
            panel.style.height = panel.scrollHeight + 'px';
        }
    }

    // Call the function to insert career pathway data when the page loads
    document.addEventListener('DOMContentLoaded', insertCareerPathwayData);
</script>

{% endblock %}
